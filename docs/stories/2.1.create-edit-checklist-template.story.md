# Story 2.1: Create & Edit a Checklist Template

**Status:** APPROVE
**Epic:** Epic 2: Core Checklist Functionality  
**Priority:** High  
**Story Points:** 8  

## Story

**As a logged-in User**, I want to create and edit a checklist template with a title and ordered steps, so that I can define a reusable process.

## Acceptance Criteria

- [ ] From the dashboard, clicking the "Create New Template" button opens a template builder view.
- [ ] The user can enter a title for the template.
- [ ] The user can add, edit, and delete text-based steps for the checklist.
- [ ] The user can reorder the steps.
- [ ] Saving the template creates a new record in the database linked to the user.
- [ ] After saving, the user is returned to the dashboard where the new template is now visible.
- [ ] An existing template can be opened in the same builder view to be edited and saved.

## Technical Notes

### Database Schema Requirements
- Create `checklist_templates` table with:
  - `id` (UUID, primary key)
  - `user_id` (UUID, foreign key to users table)
  - `title` (VARCHAR, required)
  - `created_at` (TIMESTAMP)
  - `updated_at` (TIMESTAMP)

- Create `checklist_steps` table with:
  - `id` (UUID, primary key)
  - `template_id` (UUID, foreign key to checklist_templates)
  - `step_text` (TEXT, required)
  - `order_index` (INTEGER, required for ordering)
  - `created_at` (TIMESTAMP)

### API Endpoints Needed
- `POST /api/templates` - Create new template
- `GET /api/templates` - Get user's templates
- `GET /api/templates/[id]` - Get specific template with steps
- `PUT /api/templates/[id]` - Update template
- `DELETE /api/templates/[id]` - Delete template

### UI Components Required
- Template Builder Form (`/templates/new` and `/templates/[id]/edit`)
- Step Management Interface (add/edit/delete/reorder steps)
- Dashboard Template List Component
- Create Template Button

### Business Logic
- Template ownership validation (users can only edit their own templates)
- Step ordering management
- Template validation (title required, at least one step)

## Dev Notes

- Build on existing authentication system
- Use Drizzle ORM for database operations
- Implement proper error handling and validation
- Ensure responsive design for mobile compatibility
- Add loading states and optimistic updates

## Testing

- [ ] Unit tests for template CRUD operations
- [ ] Integration tests for API endpoints
- [ ] E2E tests for template creation flow
- [ ] Validation tests for required fields
- [ ] Authorization tests (users can only access their own templates)

## Dev Agent Record

### Agent Model Used
- **Name:** James
- **Role:** Full Stack Developer
- **Specialization:** Next.js, TypeScript, Drizzle ORM

### Debug Log References
- None yet

### Completion Notes List
- None yet

### File List
- None yet

### Change Log
- 2025-01-XX: Story created by Bob (Scrum Master)

## Dependencies
- Story 1.2: User Authentication (COMPLETE)
- Database schema updates
- New API routes
- Template builder UI components 